<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Preventivo AI + Chat</title>
  <link rel="stylesheet" href="style.css" />
  <!-- pdf.js per testo da PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
</head>
<body>
  <header><h1>Preventivo AI + Chat</h1></header>

  <nav class="tabs">
    <button data-tab="quote" class="active">Preventivo</button>
    <button data-tab="chat">Chat</button>
    <button data-tab="test">Test</button>
  </nav>

  <main>
    <!-- Preventivo -->
    <section id="tab-quote" class="tab active">
      <div class="panel">
        <h2>Input</h2>
        <label>PDF tecnico (opzionale)
          <input id="pdfInput" type="file" accept="application/pdf" />
        </label>
        <label class="full">Oppure incolla testo tecnico
          <textarea id="rawText" rows="8" placeholder="Specifiche, misure, materiali, quantitÃ â€¦"></textarea>
        </label>
        <div class="grid">
          <label>â‚¬/kg materiale <input id="eurKg" type="number" step="0.01" value="1.8"></label>
          <label>â‚¬/h manodopera <input id="eurH" type="number" step="0.01" value="42"></label>
          <label>â‚¬/mÂ² verniciatura <input id="eurMq" type="number" step="0.01" value="15"></label>
        </div>
        <div class="actions">
          <button id="extractBtn">ðŸ“– Leggi PDF</button>
          <button id="quoteBtn" class="primary">ðŸ§® Calcola</button>
        </div>
        <p id="status" class="status"></p>
      </div>
      <div class="panel">
        <h2>Risultato</h2>
        <textarea id="result" class="mono" rows="16" placeholder="Il preventivo apparirÃ  quiâ€¦"></textarea>
      </div>
    </section>

    <!-- Chat -->
    <section id="tab-chat" class="tab">
      <div class="panel">
        <h2>Chat</h2>
        <div id="chatBox" class="chatbox"></div>
        <div class="row">
          <input id="chatInput" placeholder="Scrivi un messaggioâ€¦" />
          <button id="sendBtn" class="primary">Invia</button>
        </div>
        <p id="chatStatus" class="status"></p>
      </div>
    </section>

    <!-- Test -->
    <section id="tab-test" class="tab">
      <div class="panel">
        <h2>Test backend</h2>
        <div class="row">
          <button id="pingBtn">ðŸ”Ž /health</button>
          <button id="diagBtn">ðŸ§ª /diag</button>
        </div>
        <pre id="testOut" class="mono" style="min-height:120px;margin-top:10px"></pre>
      </div>
    </section>
  </main>

  <footer><small>Â© WebApp â€¢ GitHub Pages + backend esterno</small></footer>

  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
